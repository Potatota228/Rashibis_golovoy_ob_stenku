
<!-- FILE: practice11.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü—Ä–∞–∫—Ç–∏–∫–∞ 11 - –ú–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤, —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</title>
  <link href="https://fonts.googleapis.com/css2?family=Pangolin&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--primary-green:#405b22;--bg:#f2fde6;--card:#ffffffaa}
    body{font-family:Pangolin, cursive;background:var(--bg);color:#254228;padding:2rem}
    .wrap{max-width:1000px;margin:0 auto}
    .card{background:var(--card);padding:1rem;border-radius:14px;margin-bottom:1rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .btn{padding:.5rem .8rem;background:var(--primary-green);color:#fff;border:none;border-radius:8px;cursor:pointer}
    .products{margin-top:1rem}
    .product{display:flex;justify-content:space-between;padding:.6rem;border-bottom:1px dashed rgba(0,0,0,0.06)}
    input, select{padding:.5rem;border-radius:6px;border:2px solid #cfe6b8}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 style="text-align:center;color:#405b22">–ü—Ä–∞–∫—Ç–∏–∫–∞ 11 ‚Äî –¢–æ–≤–∞—Ä—ã, —Ñ–∏–ª—å—Ç—Ä, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</h1>

    <section class="card">
      <h3>–ú–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤</h3>
      <div class="controls">
        <input id="pName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" />
        <input id="pPrice" type="number" placeholder="–¶–µ–Ω–∞" />
        <button id="pAdd" class="btn">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
        <button id="pChange" class="btn">–ó–∞–º–µ–Ω–∏—Ç—å –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç</button>
        <button id="pClear" class="btn">–û—á–∏—Å—Ç–∏—Ç—å –º–∞—Å—Å–∏–≤</button>
      </div>
      <div class="note" style="margin-top:.6rem">–ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–æ—Ä–∑–∏–Ω—É (–∏–∫–æ–Ω–∫–∞) —É–¥–∞–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç; –æ—á–∏—Å—Ç–∫–∞ –æ—á–∏—â–∞–µ—Ç –º–∞—Å—Å–∏–≤.</div>
      <div id="products" class="products"></div>
    </section>

    <section class="card">
      <h3>–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏ –∏—Ç–æ–≥–æ–≤–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h3>
      <div class="controls">
        <button id="incQty" class="btn">+1 –∫ –ø–µ—Ä–≤–æ–º—É —Ç–æ–≤–∞—Ä—É</button>
        <button id="decQty" class="btn">-1 –∫ –ø–µ—Ä–≤–æ–º—É —Ç–æ–≤–∞—Ä—É</button>
        <div style="align-self:center">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: <span id="total">0</span></div>
      </div>
    </section>

    <section class="card">
      <h3>–§–∏–ª—å—Ç—Ä –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É</h3>
      <div class="controls">
        <input id="fA" type="number" placeholder="a" />
        <input id="fB" type="number" placeholder="b" />
        <button id="applyFilter" class="btn">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>
        <button id="resetFilter" class="btn">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>
      </div>
      <div style="margin-top:.6rem">–†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–ª—å—Ç—Ä–∞: <span id="filterCount">0</span> —ç–ª–µ–º.</div>
    </section>

    <section class="card">
      <h3>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</h3>
      <div class="controls">
        <button id="sortAsc" class="btn">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</button>
        <button id="sortDesc" class="btn">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</button>
      </div>
    </section>
  </div>

  <script>
    'use strict';
    // –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤ —Ç–æ–≤–∞—Ä–æ–≤
    let products = [
      {id:1, name:'–Ø–±–ª–æ–∫–æ', price:30, qty:1},
      {id:2, name:'–ì—Ä—É—à–∞', price:45, qty:2},
      {id:3, name:'–•–ª–µ–±', price:20, qty:1}
    ];

    let filteredView = null; // —Ö—Ä–∞–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Å—Å–∏–≤ (–Ω–µ –º—É—Ç–∏—Ä—É–µ—Ç products)

    function render(arr = products){
      const box = document.getElementById('products'); box.innerHTML = '';
      if(arr.length === 0) { box.innerHTML = '<div class="muted">–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç</div>'; document.getElementById('total').textContent = '0'; return; }
      arr.forEach((p, idx) => {
        const el = document.createElement('div'); el.className='product';
        el.innerHTML = `<div><strong>${escapeHtml(p.name)}</strong> <span style="color:#6b8b47">(—Ü–µ–Ω–∞: ${p.price})</span></div>
                        <div>
                          <button class="btn" data-action="dec" data-idx="${idx}">-</button>
                          <span style="margin:0 8px">${p.qty || 0}</span>
                          <button class="btn" data-action="inc" data-idx="${idx}">+</button>
                          <button class="btn" data-action="del" data-idx="${idx}" style="background:#d32f2f">üõí</button>
                        </div>`;
        box.appendChild(el);
      });
      updateTotal(arr);
    }

    function escapeHtml(str){ return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    function updateTotal(arr = products){
      const total = arr.reduce((s,i)=> s + (i.price || 0) * (i.qty || 0), 0);
      document.getElementById('total').textContent = total;
    }

    document.getElementById('pAdd').addEventListener('click', ()=>{
      const name = document.getElementById('pName').value.trim();
      const price = Number(document.getElementById('pPrice').value);
      if(!name || !price){ alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É'); return; }
      const id = Date.now(); products.push({id,name,price,qty:1}); render();
    });

    // –∑–∞–º–µ–Ω–∏—Ç—å –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –¥—Ä—É–≥–æ–π
    document.getElementById('pChange').addEventListener('click', ()=>{
      if(products.length === 0){ alert('–ú–∞—Å—Å–∏–≤ –ø—É—Å—Ç'); return; }
      const idx = Math.floor(Math.random() * products.length);
      products[idx] = {id:Date.now(), name:'–ó–∞–º–µ–Ω—ë–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä', price:99, qty:1};
      render();
    });

    document.getElementById('pClear').addEventListener('click', ()=>{ products = []; render(); });

    document.getElementById('products').addEventListener('click', (e)=>{
      const btn = e.target.closest('button'); if(!btn) return;
      const act = btn.dataset.action; const idx = Number(btn.dataset.idx);
      // note: idx relates to current rendered array ‚Äî if filter applied, use filtered view
      const arrayRef = filteredView || products;
      if(act === 'inc'){ arrayRef[idx].qty = (arrayRef[idx].qty || 0) + 1; }
      if(act === 'dec'){ arrayRef[idx].qty = Math.max(0, (arrayRef[idx].qty || 0) - 1); }
      if(act === 'del'){ arrayRef.splice(idx,1); if(filteredView){ /* need to remove from original products by id */ const removedId = arrayRef[idx] && arrayRef[idx].id; /* best-effort: rebuild products*/ products = products.filter(p=> arrayRef.findIndex(x=> x.id===p.id)!==-1); }
      }
      // If filter active, we must reflect changes to original products
      if(filteredView){ // sync by id
        const map = new Map(products.map(p=>[p.id,p]));
        filteredView.forEach(f=>{ const orig = map.get(f.id); if(orig){ orig.qty = f.qty; orig.price = f.price; }});
      }
      render(filteredView || products);
    });

    // –ø—Ä–æ—Å—Ç–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è +1/-1 –∫ –ø–µ—Ä–≤–æ–º—É —Ç–æ–≤–∞—Ä—É
    document.getElementById('incQty').addEventListener('click', ()=>{
      if(products.length===0) return; products[0].qty = (products[0].qty||0)+1; render();
    });
    document.getElementById('decQty').addEventListener('click', ()=>{ if(products.length===0) return; products[0].qty = Math.max(0,(products[0].qty||0)-1); render(); });

    // —Ñ–∏–ª—å—Ç—Ä: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –Ω–µ –º—É—Ç–∏—Ä—É—è –∏—Å—Ö–æ–¥–Ω—ã–π
    function betweenFilter(arr,a,b){
      a = Number(a); b = Number(b);
      return arr.filter(x=> x.price >= a && x.price <= b).map(x=> Object.assign({}, x));
    }

    document.getElementById('applyFilter').addEventListener('click', ()=>{
      const a = Number(document.getElementById('fA').value || 0);
      const b = Number(document.getElementById('fB').value || 0);
      if(isNaN(a) || isNaN(b)){ alert('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —á–∏—Å–ª–∞'); return; }
      filteredView = betweenFilter(products, a, b);
      document.getElementById('filterCount').textContent = filteredView.length;
      render(filteredView);
    });

    document.getElementById('resetFilter').addEventListener('click', ()=>{ filteredView = null; document.getElementById('filterCount').textContent = '0'; render(); });

    // —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
    document.getElementById('sortAsc').addEventListener('click', ()=>{
      products = products.slice().sort((a,b)=> a.price - b.price);
      render();
    });
    document.getElementById('sortDesc').addEventListener('click', ()=>{
      products = products.slice().sort((a,b)=> b.price - a.price);
      render();
    });

    render();
  </script>
</body>
</html>
